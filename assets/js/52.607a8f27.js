(window.webpackJsonp=window.webpackJsonp||[]).push([[52],{286:function(s,t,a){"use strict";a.r(t);var n=a(0),e=Object(n.a)({},(function(){var s=this,t=s.$createElement,a=s._self._c||t;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("h1",{attrs:{id:"vue-js-编码风格"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#vue-js-编码风格"}},[s._v("#")]),s._v(" vue.js 编码风格")]),s._v(" "),a("p"),a("div",{staticClass:"table-of-contents"},[a("ul",[a("li",[a("a",{attrs:{href:"#在组件销毁时用-off-清除事件监听"}},[s._v("在组件销毁时用$off清除事件监听")])]),a("li",[a("a",{attrs:{href:"#使用短横线分隔的形式命名事件"}},[s._v("使用短横线分隔的形式命名事件")])]),a("li",[a("a",{attrs:{href:"#不要忘记在-v-for-循环中使用-key"}},[s._v("不要忘记在v-for循环中使用key")])]),a("li",[a("a",{attrs:{href:"#不要在使用-v-for-的同一元素上使用-v-if"}},[s._v("不要在使用v-for的同一元素上使用v-if")])]),a("li",[a("a",{attrs:{href:"#使用-作为-mixins-的私有属性前缀"}},[s._v("使用$_作为 mixins 的私有属性前缀")])]),a("li",[a("a",{attrs:{href:"#mixin-中使用的方法或者属性应该直接在-mixin-中读取"}},[s._v("mixin 中使用的方法或者属性应该直接在 mixin 中读取")])]),a("li",[a("a",{attrs:{href:"#使用首字母大写或者短横线分隔命名单文件组件"}},[s._v("使用首字母大写或者短横线分隔命名单文件组件")])]),a("li",[a("a",{attrs:{href:"#给基础组件名加前缀"}},[s._v("给基础组件名加前缀")])]),a("li",[a("a",{attrs:{href:"#使用首字母大写命名命名-js-中的组件"}},[s._v("使用首字母大写命名命名 JS 中的组件")])]),a("li",[a("a",{attrs:{href:"#声明-prop-名时使用驼峰命名，但在模板中应使用短横线分隔命名"}},[s._v("声明 prop 名时使用驼峰命名，但在模板中应使用短横线分隔命名")])]),a("li",[a("a",{attrs:{href:"#遵循样式指南中的组件选项顺序"}},[s._v("遵循样式指南中的组件选项顺序")])]),a("li",[a("a",{attrs:{href:"#actions-必须有返回值"}},[s._v("Actions 必须有返回值")])]),a("li",[a("a",{attrs:{href:"#在-actions-和-getters-中使用选择器"}},[s._v("在actions和getters中使用选择器")])])])]),a("p"),s._v(" "),a("div",{staticClass:"custom-block tip"},[a("p",{staticClass:"custom-block-title"},[s._v("前言")]),s._v(" "),a("p",[s._v("经过一段时间对 VueJs 官方文档以及网上其他相关 vue 资源的研究，我整理了一份最佳实践和样式指南列表，方便大家写出更正确、更容易让小伙伴接受的 vue 代码。 以下有几点是一些功能/优化相关，其他是 VueJs 命名约定和元素排序相关。更多详细信息可以直接到最下方的总结中查看。")])]),s._v(" "),a("h2",{attrs:{id:"在组件销毁时用-off清除事件监听"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#在组件销毁时用-off清除事件监听"}},[s._v("#")]),s._v(" 在组件销毁时用"),a("code",[s._v("$off")]),s._v("清除事件监听")]),s._v(" "),a("p",[s._v("当我们使用"),a("code",[s._v("$on")]),s._v("进行事件监听时，要记住在"),a("code",[s._v("destroyed()")]),s._v("钩子中用"),a("code",[s._v("$off")]),s._v(" 移除事件监听，可以有效防止内存泄漏。")]),s._v(" "),a("div",{staticClass:"language-js line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// Emitting")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("this")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("$emit")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'my-event'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// instead of myEvent")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// Listening")]),s._v("\nv"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("on"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v("my"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("event\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br")])]),a("h2",{attrs:{id:"使用短横线分隔的形式命名事件"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#使用短横线分隔的形式命名事件"}},[s._v("#")]),s._v(" 使用短横线分隔的形式命名事件")]),s._v(" "),a("p",[s._v("触发/监听自定义事件时，应该始终使用短横线分隔。为什么呢？因为无论如何最后事件名都会被自动转换为短横线分隔的形式。我们不应该用驼峰命名或者首字母大写的形式给监听事件命名，而是使用一种更清晰有意义的方式来声明一个事件：短横线分隔")]),s._v(" "),a("div",{staticClass:"language-js line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// Emitting")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("this")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("$emit")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'my-event'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// instead of myEvent")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// Listening")]),s._v("\nv"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("on"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v("my"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("event\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br")])]),a("h2",{attrs:{id:"不要忘记在v-for循环中使用key"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#不要忘记在v-for循环中使用key"}},[s._v("#")]),s._v(" 不要忘记在"),a("code",[s._v("v-for")]),s._v("循环中使用"),a("code",[s._v("key")])]),s._v(" "),a("p",[s._v("最常见的做法是始终在模板循环中添加"),a("code",[s._v(":key")]),s._v(" 键。没有"),a("code",[s._v(":key")]),s._v(" 键的 "),a("code",[s._v("v-for")]),s._v(" 循环在错误定位的时候比较麻烦，特别与是动画相关的场景。")]),s._v(" "),a("h2",{attrs:{id:"不要在使用v-for的同一元素上使用v-if"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#不要在使用v-for的同一元素上使用v-if"}},[s._v("#")]),s._v(" 不要在使用"),a("code",[s._v("v-for")]),s._v("的同一元素上使用"),a("code",[s._v("v-if")])]),s._v(" "),a("p",[s._v("这种做法堪称性能杀手，列表数据越大，这种做法对性能的影响越大")]),s._v(" "),a("p",[s._v("用代码来看下问题吧，看以下场景：")]),s._v(" "),a("div",{staticClass:"language-vue line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-vue"}},[a("code",[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),s._v("ul")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),s._v("li")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v("v-for")]),a("span",{pre:!0,attrs:{class:"token attr-value"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v('"')]),s._v("game in gameList"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v('"')])]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v("v-if")]),a("span",{pre:!0,attrs:{class:"token attr-value"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v('"')]),s._v("game.isActive"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v('"')])]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v(":key")]),a("span",{pre:!0,attrs:{class:"token attr-value"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v('"')]),s._v("game.slug"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v('"')])]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("\n    {{ game.title }}\n  "),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),s._v("li")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("</")]),s._v("ul")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br")])]),a("p",[s._v("它类似于执行下面的代码：")]),s._v(" "),a("div",{staticClass:"language-js line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("this")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("gameList"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("map")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[s._v("game")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=>")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("game"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("isActive"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),s._v(" game"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("title\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br")])]),a("p",[s._v("我们可以在这里看到，我们将不得不迭代整个"),a("code",[s._v("gameList")]),s._v("数组，无论"),a("code",[s._v("game.isActive")]),s._v("是否已经改变")]),s._v(" "),a("p",[s._v("在像"),a("code",[s._v("Angular")]),s._v("这样的其他框架中，这种做法不会被编译（"),a("code",[s._v("ngIf")]),s._v("不能进入有"),a("code",[s._v("ngFor")]),s._v("的同一元素）")]),s._v(" "),a("h2",{attrs:{id:"使用-作为-mixins-的私有属性前缀"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#使用-作为-mixins-的私有属性前缀"}},[s._v("#")]),s._v(" 使用"),a("code",[s._v("$_")]),s._v("作为 mixins 的私有属性前缀")]),s._v(" "),a("p",[s._v("Mixins 在代码复用上是个不错的方法，它可以将重复代码组合成一个单独的模块，然后按需引入。但是（极大可能），会出现一些问题。下面，我们重点解决属性名重复冲突的问题。")]),s._v(" "),a("p",[s._v("当我们将"),a("code",[s._v("mixin")]),s._v("混入组件时，也就是将"),a("code",[s._v("mixin")]),s._v("内的代码与组件自身的代码进行合并，如果碰到同名属性，会发生什么？组件优先级更高，组件属性的优先级自然更高。")]),s._v(" "),a("p",[s._v("如果我想让 mixin 代码的优先级更高，应该怎么办？我们无法分配优先级，但可以通过正确的命名规范来避免属性重叠或者覆盖。")]),s._v(" "),a("p",[s._v("为了区分 mixin 属性和组件的属性，我们通常使用"),a("code",[s._v("$_")]),s._v("作为属性前缀，为什么呢？主要有下面几个原因：")]),s._v(" "),a("ol",[a("li",[s._v("来自"),a("a",{attrs:{href:"https://cn.vuejs.org/v2/style-guide/index.html",target:"_blank",rel:"noopener noreferrer"}},[s._v("VueJs 风格指南"),a("OutboundLink")],1),s._v("的建议")]),s._v(" "),a("li",[s._v("Vue 使用 "),a("code",[s._v("_")]),s._v("前缀来定义其自身的私有属性")]),s._v(" "),a("li",[a("code",[s._v("$")]),s._v("是 Vue 生态系统暴露给用户的特殊实例属性")])]),s._v(" "),a("h2",{attrs:{id:"mixin-中使用的方法或者属性应该直接在-mixin-中读取"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#mixin-中使用的方法或者属性应该直接在-mixin-中读取"}},[s._v("#")]),s._v(" mixin 中使用的方法或者属性应该直接在 mixin 中读取")]),s._v(" "),a("p",[s._v("继"),a("code",[s._v("mixin")]),s._v("上一点，还有另一点要注意的")]),s._v(" "),a("p",[s._v("假设我们创建了一个"),a("code",[s._v("mixin")]),s._v("，它使用了"),a("code",[s._v("this.language")]),s._v("属性，但这个属性并不是在"),a("code",[s._v("mixin")]),s._v("内部定义或获取的，那么混入了这个 mixin 的组件就必须包含这个"),a("code",[s._v("language")]),s._v("属性。")]),s._v(" "),a("p",[s._v("正如你已经知道的，这非常容易出错。为了提前避免错误的发生，"),a("code",[s._v("mixin")]),s._v("内使用到的属性或者方法最好只在"),a("code",[s._v("mixin")]),s._v("内部定义获取。不必担心重复获取属性的问题，因为 VueJs 在这点上很聪明，如果检测到重复读取属性，将会自动处理（大部分情况下是直接从 Vuex 里直接读取）。")]),s._v(" "),a("h2",{attrs:{id:"使用首字母大写或者短横线分隔命名单文件组件"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#使用首字母大写或者短横线分隔命名单文件组件"}},[s._v("#")]),s._v(" 使用首字母大写或者短横线分隔命名单文件组件")]),s._v(" "),a("p",[s._v("编辑器对首字母大写命名的集成度更好，对在常用 IDE 中实现自动完成/导入功能更友好。")]),s._v(" "),a("p",[s._v("如果我们想要避免文件系统大小写不敏感的问题，那么最好选择短横线分隔")]),s._v(" "),a("h2",{attrs:{id:"给基础组件名加前缀"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#给基础组件名加前缀"}},[s._v("#")]),s._v(" 给基础组件名加前缀")]),s._v(" "),a("p",[s._v("对于展示组件、纯组件，应该给它们加上前缀，以区别于其他的非纯组件。这可以大大提高项目可读性，提高团队协同开发体验。")]),s._v(" "),a("h2",{attrs:{id:"使用首字母大写命名命名-js-中的组件"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#使用首字母大写命名命名-js-中的组件"}},[s._v("#")]),s._v(" 使用首字母大写命名命名 JS 中的组件")]),s._v(" "),a("p",[s._v("在 JavaScript 中，类和原型构造函数有默认约定使用首字母大写命名，在 Vue 组件中使用首字母大写命名有相同的意义。 如果我们只通过"),a("code",[s._v("Vue.component")]),s._v("使用全局组件定义，建议使用短横线分隔命名")]),s._v(" "),a("h2",{attrs:{id:"声明-prop-名时使用驼峰命名，但在模板中应使用短横线分隔命名"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#声明-prop-名时使用驼峰命名，但在模板中应使用短横线分隔命名"}},[s._v("#")]),s._v(" 声明 prop 名时使用驼峰命名，但在模板中应使用短横线分隔命名")]),s._v(" "),a("p",[s._v("遵循每种语言的惯例：JavaScript（驼峰）和 HTML（短横线分割），在 JS 中定义 prop 时用驼峰命名，在 HTML 中用于短横线分割命名。")]),s._v(" "),a("h2",{attrs:{id:"遵循样式指南中的组件选项顺序"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#遵循样式指南中的组件选项顺序"}},[s._v("#")]),s._v(" 遵循样式指南中的组件选项顺序")]),s._v(" "),a("p",[s._v("这样做可能看起来有点死板，但是在整个项目中对组件的所有选项执行相同的顺序，在查找内容和创建新组件时有很大帮助。")]),s._v(" "),a("p",[s._v("VueJs 样式指南可以查看这里"),a("a",{attrs:{href:"https://link.juejin.im/?target=https%3A%2F%2Fcn.vuejs.org%2Fv2%2Fstyle-guide%2Findex.html",target:"_blank",rel:"noopener noreferrer"}},[s._v("风格指南 — Vue.js"),a("OutboundLink")],1)]),s._v(" "),a("h2",{attrs:{id:"actions-必须有返回值"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#actions-必须有返回值"}},[s._v("#")]),s._v(" Actions 必须有返回值")]),s._v(" "),a("p",[s._v("这跟"),a("code",[s._v("async/await")]),s._v("和 Vuex 的 "),a("code",[s._v("actions")]),s._v("有关")]),s._v(" "),a("p",[s._v("看以下例子：")]),s._v(" "),a("div",{staticClass:"language-js line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// Store")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token constant"}},[s._v("SOME_ACTION")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n   "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 做点什么，需要一段时间才能执行完")]),s._v("\n   console"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("log")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'Action done'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// Consuming action")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("async")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("doSomething")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("await")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("dispatch")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token constant"}},[s._v("SOME_ACTION")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n  console"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("log")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'Do stuff now'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\nThis will output\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// Do stuff now")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// Action done")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br")])]),a("p",[s._v("发生这种情况是因为 "),a("code",[s._v("await")]),s._v(" 不知道要等待什么，相反，如果我们实际上返回了 "),a("code",[s._v("Promise.resolve（）")]),s._v("，则 "),a("code",[s._v("await")]),s._v(" 将等待解析，然后再继续")]),s._v(" "),a("div",{staticClass:"language-js line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// Store")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token constant"}},[s._v("SOME_ACTION")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n   "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 做点什么，需要一段时间才能执行完")]),s._v("\n   console"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("log")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'Action done'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n   Promise"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("resolve")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// Consuming action")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("async")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("doSomething")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("await")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("dispatch")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token constant"}},[s._v("SOME_ACTION")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n  console"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("log")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'Do stuff now'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\nThis will output"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// Action done")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// Do stuff now")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br")])]),a("h2",{attrs:{id:"在actions和getters中使用选择器"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#在actions和getters中使用选择器"}},[s._v("#")]),s._v(" 在"),a("code",[s._v("actions")]),s._v("和"),a("code",[s._v("getters")]),s._v("中使用选择器")]),s._v(" "),a("p",[s._v("创建选择器时，不单只是在应用逻辑中使用，还要在 Vuex store 中使用")]),s._v(" "),a("p",[s._v("直接用代码会更容易解释：")]),s._v(" "),a("div",{staticClass:"language-js line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 假设我们读取以下language属性")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("export")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("const")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function-variable function"}},[s._v("language")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[s._v("state")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=>")]),s._v(" state"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("userConfig"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("language\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 在其中一个actions中, 需要用到language:")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 不好的例子")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token constant"}},[s._v("GET_GAMES")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" commit"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" rootState "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n   "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("const")]),s._v(" lang "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" rootState"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("userConfig"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("language\n   "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// Do stuff...")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 正确的例子")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token constant"}},[s._v("GET_GAMES")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" commit"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" rootState "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n   "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("const")]),s._v(" lang "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("language")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("rootState"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n   "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// Do stuff...")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br")])])])}),[],!1,null,null,null);t.default=e.exports}}]);